---
include:
  - docassemble.AssemblyLine:al_package.yml
  - docassemble.ALMassachusetts:al_massachusetts.yml
  - docassemble.MassAccess:massaccess.yml
---
metadata:
  title: |
    Child Support Guidelines Worksheet
  short title: |
    Child Support Guidelines Worksheet
  authors:
    - Hayden McGuire
---
mandatory: True
comment: |
  Global interview metadata
variable name: interview_metadata["child_support_guidelines_worksheet"]
data:
  al_weaver_version: "1.6.3"
  generated on: "2022-06-27"
  title: >-
    Child Support Guidelines Worksheet
  short title: >-
    Child Support Guidelines Worksheet
  description: |-
    Form that assists a litigant in determining what child support payements will be.
  original_form: >-
    https://courtforms.jud.state.ma.us/publicforms/PFC0001_2021
  allowed courts: []
  categories: []
  typical role: "unknown"
  generate download screen: True
---
code: |
  interview_metadata['main_interview_key'] =  'child_support_guidelines_worksheet'
---
code: |
  # This controls the default country and list of states in address field questions
  AL_DEFAULT_COUNTRY = "US"
---
code: |
  # This controls the default state in address field questions
  AL_DEFAULT_STATE = "MA"
---
code: |
  github_repo_name =  'docassemble-ChildSupportGuidelinesWorksheet'
---
code: |
  interview_short_title = "Determining what is owed for child support payments"
---
code: |
  al_form_type = "other" 
---
objects:
  - users: ALPeopleList.using(there_are_any=False)
  - preparer: ALPeopleList.using(ask_number=True,target_number=1)
---
sections:
  - review_child_support_guidelines_worksheet: Review your answers
---
#################### Interview order #####################
comment: |
  Controls order and branching logic for questions specific to this form
id: interview_order_child_support_guidelines_worksheet
code: |
  # Set the allowed courts for this interview
  allowed_courts = interview_metadata["child_support_guidelines_worksheet"]["allowed courts"]
  nav.set_section('review_child_support_guidelines_worksheet')
  # Below sets the user_role by asking a question.
  # You can set user_role directly instead to either 'plaintiff' or 'defendant'
  # user_ask_role
  prepared_date
  case_name
  children_number
  set_parenting_arangment
  set_progress(14)
  set_parents2_under_18_number
  parents1_under_18_number
  set_both_over_18_number
  parents1_name_full
  parents1_gross_amount
  parents2_gross_amount
  set_progress(28)
  parents1_other_obligations_amount
  parents2_other_obligations_amount
  parents1_child2_amount
  set_progress(42)
  parents2_child1_amount
  set_default_children_amounts
  set_progress(57)
  calculate_parents2_available_income_amount
  calculate_parents1_available_income_amount
  calculate_combined_available_income_amount
  calculate_applicable_income_amount 
  calculate_one_child_support_amount
  calculate_parents1_income_share_percent
  calculate_parents2_income_share_percent
  calculate_parents1_other_low_income_adjusted
  calculate_parents2_other_low_income_adjusted
  calculate_parents2_child_number_adjustments
  calculate_parents1_child_number_adjustments
  calculate_parents1_children_adjustments
  calculate_parents2_children_adjustments
  calculate_parents1_other_limited_adjusted_amount
  set_parents1_income_support_precent
  set_parents1_share_support_percent
  set_parents2_share_support_amount
  set_parents1_other_share_support
  set_parents2_other_share_support
  set_combined_additional_income_amount 
  parents1_benchmark_amount
  parents2_benchmark_amount
  interview_order_child_support_guidelines_worksheet = True
---
###################### Main order ######################
comment: |
  This block includes the logic for standalone interviews.
  Delete mandatory: True to include in another interview
mandatory: True
code: |
  al_intro_screen
  child_support_guidelines_worksheet_intro
  interview_order_child_support_guidelines_worksheet
  #signature_date    
  #Save anonymized interview statistics (customize the saved data below)
  #store_variables_snapshot(data={'zip': users[0].address.zip})    
  child_support_guidelines_worksheet_preview_question
  #basic_questions_signature_flow    
  child_support_guidelines_worksheet_download
---
comment: |
  This question is used to introduce your interview. Please customize
id: Child_Support_Guidelines_Worksheet
continue button field: child_support_guidelines_worksheet_intro
question: |
  Child Support Guidelines Worksheet
subquestion: |
  This guided interview will help you determine how much child support will be owed.  
  
  To complete the interview you need to have income and expense information for **both parents**. Use the other parent’s Financial Statement if you have it. If you do not know the other parent’s information, put in what you think it is.  
  
  This interview is intended to make the [Child Support Worksheet](https://courtforms.jud.state.ma.us/publicforms/PFC0001_2021) a simpiler and less time consuming process to complete. It is based on the Massachusetts [Child Support Guidlines for 2021](https://www.mass.gov/doc/2021-child-support-guidelines/download). It will create a completed copy of the Child Support Worksheet.
---
id: Preparer information
question: |
  Preparer Information
subquestion: |
  Please give the full name of who is filling out this worksheet, and what todays date is.
fields:
  - "Who is filling out this worksheet?": preparer_name_full
    maxlength: 28
  - "What date is this worksheet being prepared on?": prepared_date
    datatype: date
    default: |
       ${ today() }
---
id: Case Information
question: |
  What is the case name and the docket number? 
fields:
  - "What is the name of the case?": case_name
    maxlength: 29
    hint: |
      Jane Doe v. John Smith
  - "Please provide the docket number for the case.": docket_number
    maxlength: 29
    hint: |
      e.g. SU15D004CS
    help: |
      The docket number should be a 11 digit string of numbers and letters.
---
question: |
  What parenting arangment is closest to yours?
fields:
  - "Total number of children?": children_number    
    datatype: number    
    help: Input what you think the total number of children that are eligible for support payments under this order.
  - Choose: parenting_arangment
    input type: radio
    choices:
      - Box 1 Parenting and financial responsibilties are **shared** mostly equally.: shared
      - Box 2 The children live with one parent about **two-thirds** of the time.: two-thirds
      - Box 3 The children are **split** between the parents, and each parent has primary custody of atleast one child.: split      
  - "You said that a parent has the children 2/3rds or more of the time, whats their name?": parents1_name_full
    show if: 
      variable: parenting_arangment
      is: two-thirds
#  help: |  
#    Pick the choice from the options that you think is most similar to yours.   
#    
#    **Box 1 ** should be selected if the children live with you and the other parent about the same amount of time, and you and the other parent have mostly equal financial responsibility for the children.
#    
#    **Box 2** should be selected if the children live with one parent at least two-thirds of the time. This is the case when children live with one parent Monday-Friday, or when the children stay with one parent for one week, but the other for two. 
#    
#    **Box 3** should be selected if more than one child is covered by the order and they do not all live with the same parent. For example one child lives mostly with one parent and the other children live with the other parent. If each parent has atleast one child who lives with them the majority of the time, or each parent's house is the home for one or more children, this is the correct box to select.
---
id: sets parenting_arangment
depends on:
  - parenting_arangment
code: |
  if parenting_arangment == 'shared':
    shared_equal_yes = True
    two_thirds_yes = False
    split_children_yes = False
  elif parenting_arangment == 'two-thirds':
    shared_equal_yes = False
    two_thirds_yes = True
    split_children_yes = False
  elif parenting_arangment == 'split':
    shared_equal_yes = False
    two_thirds_yes = False
    split_children_yes = True
  set_parenting_arangment = True 
---
id: What are the parents names?
question: |
  What are the names of the parents involved in this order?   
fields:    
  - "What is the first parents name?": parents1_name_full
    maxlength: 29
    #hide if: 
    #  variable: parenting_arangment
    #  is: "two-thirds"
  - "What is the other parents name?": parents2_name_full
    maxlength: 29 
---
# sets parents2 children to 0 when needed.
depends on:
  - parenting_arangment
code: |
  if parenting_arangment == "two-thirds":
    parents2_under_18_number = 0
  set_parents2_under_18_number = True
---
id: What are the ages of the children this order concerns?
question: |
  What is the number and the age's of the children for whom each parent may be eligible to receive support?
subquestion: |
  As a **reminder** you said the parenting arangment was **${ parenting_arangment }**.

  If the parenting arangment is **shared**, put **${ children_number }** each parents box.
       
  If the parenting arangment is **two-thirds**, and the children are with ${ parents1_name_full } more than **two-third's** of the time put **${ children_number }** in ${ parents1_name_full }'s box and keep **0** in ${ parents2_name_full }'s box.
      
  If the parenting arangment is **split**, meaning some children live with each parent, put the number of children living with each parent in the respective fields. 
fields:
  - "How many of ${ parents1_name_full }'s children are under 18 years old?": parents1_under_18_number
    datatype: number    
  - "How many of ${ parents2_name_full }'s children are under 18 years old?": parents2_under_18_number
    datatype: number
  - "Are there children involved that are over 18 years old?": any_children_over_18
    datatype: yesnoradio
  - "How many of ${ parents1_name_full }'s children are over 18 years old?": parents1_over_18_number
    datatype: number
    show if: any_children_over_18        
  - "How many of ${ parents2_name_full }'s children are over 18 years old?": parents2_over_18_number
    datatype: number
    show if: any_children_over_18
# want this under note to ${ show if: any_children_over_18 } 
under: |
      The judge will look at the following reasons for including these children in the order:
     
      * Your child’s living situation, like why your child lives with you, and when and how much time they live with you;
      * Why your child is mainly dependent on you;
      * Your child’s academic situation, like their progress in school, or if they are part-time of full-time;
      * All kinds of resources the parents may have, like a bedroom for the child or the ability to help with school work; and
      * Each parent’s contribution to post-secondary education costs for the child or other children in the family.
---
# sets over_18 values if none
depends on:
  - any_children_over_18 
code: |
  if any_children_over_18 == False:
    parents1_over_18_number = 0
    parents2_over_18_number = 0
  set_both_over_18_number = True
---
id: What does Parents 1 income situation look like
question: |
  What does ${ parents1_name_full } income situation look like?
subquestion: |
  Weekly gross income and social security benefits collected.
fields:
  - "What is ${ parents1_name_full } gross weekly income?": parents1_gross_amount
    datatype: currency
    min: 0
    help: |
      **Gross Weekly Income** is your income before taxes and deductions are taken out. It does not include public assistance like welfare, TAFDC, SSI, and Food Stamps SNAP.
  - "What is ${ parents1_name_full } Social Security benefit?": parents1_SS_dependency_amount
    datatype: currency
    min: 0
  - "How much of ${ parents1_name_full } SS benefit is sent directly to them?": parents1_SS_dependency_recievied_amount
    datatype: currency
    min: 0
---
id: What does ${ parents2_name_full } income situation look like
question: |
  What does ${ parents2_name_full } income situation look like?
subquestion: |
  Weekly gross income and social security benefits collected.
fields:
  - "What is ${ parents2_name_full } gross weekly income?": parents2_gross_amount
    datatype: currency
    min: 0
  - "How much is ${ parents2_name_full } Social Security benefit?": parents2_SS_dependency_amount
    datatype: currency
    min: 0
  - "How much of ${ parents2_name_full } SS benefit is sent directly to them?": parents2_SS_dependency_recievied_amount
    datatype: currency
    min: 0
---
id: How much does Parents 1 pay for health and other expenses
question: |
  How much does ${ parents1_name_full } pay for health and other expenses?
subquestion: |
  Other Obligations, Health Insurance, Dental/Vision Insurance
fields:
  - "How much does ${ parents1_name_full } pay in support for other obligations:": parents1_other_obligations_amount
    datatype: currency
    min: 0
  - "How much does ${ parents1_name_full } pay for health insurance enrollment?": parents1_health_care_amount
    datatype: currency
    min: 0
  - "How much does ${ parents1_name_full } pay for dental and vision insurance?": parents1_dental_vision_amount
    datatype: currency
    min: 0
---
id: How much does Parents 2 pay for health and other expenses
question: |
  How much does ${ parents2_name_full } pay for health and other expenses?
subquestion: |
  Other Obligations, Health Insurance, Dental/Vision Insurance
fields:
  - "How much does ${ parents2_name_full } pay in support for other obligations:": parents2_other_obligations_amount
    datatype: currency
    min: 0
  - "How much does ${ parents2_name_full } pay for health insurance enrollment?": parents2_health_care_amount
    datatype: currency
    min: 0
  - "How much does ${ parents2_name_full } pay for dental and vision insurance?": parents2_dental_vision_amount
    datatype: currency
    min: 0
---
id: How much does Parents1 pay for each child
question: |
  How much does ${ parents1_name_full } pay for each child?
subquestion: |
  Give the child care costs amount paid in support for each child.
fields:
  - "What are the child care costs for Child 1 paid by this order?": parents1_child1_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 1 
  - "What are the child care costs for Child 2 paid by this order?": parents1_child2_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 2
  - "What are the child care costs for Child 3 paid by this order?": parents1_child3_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 3
  - "What are the child care costs for Child 4 paid by this order?": parents1_child4_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 4
  - "What are the child care costs for Child 5 paid by this order?": parents1_child5_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 5
---
id: How much does Parents2 pay in support for each child
question: |
  How much does ${ parents2_name_full } pay in support for each child?
subquestion: |
  Give the allocated amount paid in support for each child.
fields:
  - "What are the child care costs for Child 1 paid by this order?": parents2_child1_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 1
  - "What are the child care costs for Child 2 paid by this order?": parents2_child2_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 2
  - "What are the child care costs for Child 3 paid by this order?": parents2_child3_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 3
  - "What are the child care costs for Child 4 paid by this order?": parents2_child4_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 4
  - "What are the child care costs for Child 5 paid by this order?": parents2_child5_amount
    datatype: currency
    min: 0
    show if: 
      code: |
        children_number >= 5
---
code: |
  if children_number == 1:
    parents1_child2_amount = 0
    parents1_child3_amount = 0
    parents1_child4_amount = 0
    parents1_child5_amount = 0
    parents2_child2_amount = 0
    parents2_child3_amount = 0
    parents2_child4_amount = 0
    parents2_child5_amount = 0
  elif children_number == 2:
    parents1_child3_amount = 0
    parents1_child4_amount = 0
    parents1_child5_amount = 0
    parents2_child3_amount = 0
    parents2_child4_amount = 0
    parents2_child5_amount = 0
  elif children_number == 3:
    parents1_child4_amount = 0
    parents1_child5_amount = 0
    parents2_child4_amount = 0
    parents2_child5_amount = 0
  elif children_number == 4:
    parents1_child5_amount = 0
    parents2_child5_amount = 0
  set_default_children_amounts = True
---
id: preview child_support_guidelines_worksheet
question: |
  Preview your form before you sign it
subquestion: |
  Here is a preview of the form you will sign on the next page.   
  
  ${ al_recipient_bundle.as_pdf(key='preview') }

  Click the image to open it in a new tab. Click the "Edit answers" button
  to edit your answers.

  ${ action_button_html(url_action('review_child_support_guidelines_worksheet'), label='Edit answers', color='info') }
  
  Remember to come back to this window to continue and sign your form.
continue button field: child_support_guidelines_worksheet_preview_question    
---
code: |
  mass_gov_yes = DAEmpty()
---
id: child support guidelines worksheet review screen
event: review_child_support_guidelines_worksheet
question: |
  Review your answers
review:
  - Edit: case_name
    button: |
      **What is the name of the case?**:
      ${ case_name }
  - Edit: prepared_date
    button: |
      **What date is this worksheet being prepared on?**:
      ${ prepared_date }
  - Edit: children_number
    button: |
      **What is the total number of children that might be eligible for support payements?**:
      ${ children_number }
  - Edit: shared_equal_yes
    button: |
      **Are financial responsibilities and parenting times split equally?**:
      ${ word(yesno(shared_equal_yes)) }
  - Edit: two_thirds_yes
    button: |
      **Do the children reside with one parent two-thirds of the time?**:
      ${ word(yesno(two_thirds_yes)) }
  - Edit: split_children_yes
    button: |
      **Does each parent provide a primary residence for at least one child?**:
      ${ word(yesno(split_children_yes)) }
  - Edit: parents1_under_18_number
    button: |
      **How many of Parents1 children are under 18 years old?**:
      ${ parents1_under_18_number }
  - Edit: parents2_under_18_number
    button: |
      **How many of Parents2 children are under 18 years old?**:
      ${ parents2_under_18_number }
  - Edit: parents1_over_18_number
    button: |
      **How many of Parents1 children are over 18 years old?**:
      ${ parents1_over_18_number }
  - Edit: parents2_over_18_number
    button: |
      **How many of Parents2 children are over 18 years old?**:
      ${ parents2_over_18_number }
  - Edit: parents1_total_children_number
    button: |
      **Total number of children for Parents1:**:
      ${ parents1_total_children_number }
  - Edit: parents2_total_children_number
    button: |
      **Total number of children for Parents2:**:
      ${ parents2_total_children_number }
  - Edit: parents1_gross_amount
    button: |
      **What is Parents1 gross weekly income?**:
      ${ currency(parents1_gross_amount) }
  - Edit: parents2_gross_amount
    button: |
      **What is Parents2 gross weekly income?**:
      ${ currency(parents2_gross_amount) }
  - Edit: parents1_SS_dependency_amount
    button: |
      **How much is Parents1 Social Security benefit?**:
      ${ currency(parents1_SS_dependency_amount) }
  - Edit: parents2_SS_dependency_amount
    button: |
      **How much is Parents2 Social Security benefit?**:
      ${ currency(parents2_SS_dependency_amount) }
  - Edit: parents2_SS_dependency_recievied_amount
    button: |
      **How much of Parents2 SS benefit is sent directly to them?**:
      ${ currency(parents2_SS_dependency_recievied_amount) }
  - Edit: parents1_SS_dependency_recievied_amount
    button: |
      **How much of Parents1 SS benefit is sent directly to them?**:
      ${ currency(parents1_SS_dependency_recievied_amount) }
  - Edit: parents1_other_obligations_amount
    button: |
      **How much does Parents1 pay in support for other obligations:**:
      ${ currency(parents1_other_obligations_amount) }
  - Edit: parents2_other_obligations_amount
    button: |
      **How much does Parents2 pay in support for other obligations:**:
      ${ currency(parents2_other_obligations_amount) }
  - Edit: parents1_health_care_amount
    button: |
      **How much does Parents1 pay for health insurance enrollment?**:
      ${ currency(parents1_health_care_amount) }
  - Edit: parents2_health_care_amount
    button: |
      **How much does Parents2 pay for health insurance enrollment?**:
      ${ currency(parents2_health_care_amount) }
  - Edit: parents1_dental_vision_amount
    button: |
      **How much does Parents1 pay for dental and vision insurance?**:
      ${ currency(parents1_dental_vision_amount) }
  - Edit: parents2_dental_vision_amount
    button: |
      **How much does Parents2 pay for dental and vision insurance?**:
      ${ currency(parents2_dental_vision_amount) }
  - Edit: parents1_child2_amount
    button: |
      **Parents1 What are the child care costs for Child 2 paid by this order?**:
      ${ currency(parents1_child2_amount) }
  - Edit: parents1_child5_amount
    button: |
      **Parents1 What are the child care costs for Child 5 paid by this order?**:
      ${ currency(parents1_child5_amount) }
  - Edit: parents1_child1_amount
    button: |
      **Parents1 What are the child care costs for Child 1 paid by this order?**:
      ${ currency(parents1_child1_amount) }
  - Edit: parents1_child3_amount
    button: |
      **Parents1 What are the child care costs for Child 3 paid by this order?**:
      ${ currency(parents1_child3_amount) }
  - Edit: parents1_child4_amount
    button: |
      **Parents1 What are the child care costs for Child 4 paid by this order?**:
      ${ currency(parents1_child4_amount) }
  - Edit: parents1_all_children_amount
    button: |
      **What are the child care costs of all children for Parents1?**:
      ${ parents1_all_children_amount }
  - Edit: parents2_all_children_amount
    button: |
      **What are the child care costs of all children for Parents2?**:
      ${ parents2_all_children_amount }
  - Edit: parents2_child1_amount
    button: |
      **Parents2 What are the child care costs for Child 1 paid by this order?**:
      ${ currency(parents2_child1_amount) }
  - Edit: parents2_child2_amount
    button: |
      **Parents2 What are the child care costs for Child 2 paid by this order?**:
      ${ currency(parents2_child2_amount) }
  - Edit: parents2_child3_amount
    button: |
      **Parents2 What are the child care costs for Child 3 paid by this order?**:
      ${ currency(parents2_child3_amount) }
  - Edit: parents2_child4_amount
    button: |
      **Parents2 What are the child care costs for Child 4 paid by this order?**:
      ${ currency(parents2_child4_amount) }
  - Edit: parents2_child5_amount
    button: |
      **Parents2 What are the child care costs for Child 5 paid by this order?**:
      ${ currency(parents2_child5_amount) }
  - Edit: child2_total_amount
    button: |
      **Child2 total amount**:
      ${ child2_total_amount }
  - Edit: child3_total_amount
    button: |
      **Child3 total amount**:
      ${ child3_total_amount }
  - Edit: child4_total_amount
    button: |
      **Child4 total amount**:
      ${ child4_total_amount }
  - Edit: child5_total_amount
    button: |
      **Child5 total amount**:
      ${ child5_total_amount }
  - Edit: child1_total_amount
    button: |
      **Child1 total amount**:
      ${ child1_total_amount }
  - Edit: parents2_available_income_amount
    button: |
      **Parents2 income available amount**:
      ${ parents2_available_income_amount }
  - Edit: parents1_available_income_amount
    button: |
      **Parents1 income available amount**:
      ${ parents1_available_income_amount }
  - Edit: combined_available_income_amount
    button: |
      **Total available income amount (both parents)**:
      ${ combined_available_income_amount }
  - Edit: parents2_income_share_percent
    button: |
      **Parents2 income share percent**:
      ${ parents2_income_share_percent }
  - Edit: parents1_income_share_percent
    button: |
      **Parents1 income share percent**:
      ${ parents1_income_share_percent }
  - Edit: applicable_income_amount
    button: |
      **Applicable income amount**:
      ${ applicable_income_amount }
  - Edit: one_child_support_amount
    button: |
      **One child support amount**:
      ${ one_child_support_amount }
  - Edit: parents2_child_number_adjustments
    button: |
      **Parents2 adjustments**:
      ${ parents2_child_number_adjustments }
  - Edit: parents1_child_number_adjustments
    button: |
      **Parents1 adjustments**:
      ${ parents1_child_number_adjustments }
  - Edit: parents2_support_amount
    button: |
      **Parents2 support amount**:
      ${ parents2_support_amount }
  - Edit: parents1_support_amount
    button: |
      **Parents1 support amount**:
      ${ parents1_support_amount }
  - Edit: parents1_children_adjustments
    button: |
      **Parents1 children adjustments**:
      ${ parents1_children_adjustments }
  - Edit: parents2_children_adjustments
    button: |
      **Parents2 children adjustments**:
      ${ parents2_children_adjustments }
  - Edit: parents1_over_18_adjustments_amount
    button: |
      **Parents1 over 18 adjustments amount**:
      ${ parents1_over_18_adjustments_amount }
  - Edit: parents2_over_18_adjustments_amount
    button: |
      **Parents2 over 18 adjustments amount**:
      ${ parents2_over_18_adjustments_amount }
  - Edit: parents1_adjusted_support_amount
    button: |
      **Parents1 adjusted support amount**:
      ${ parents1_adjusted_support_amount }
  - Edit: parents2_adjusted_support_amount
    button: |
      **Parents2 adjusted support amount**:
      ${ parents2_adjusted_support_amount }
  - Edit: parents1_share_support_amount
    button: |
      **Parents1 share support amount**:
      ${ currency(parents1_share_support_amount) }
  - Edit: parents2_share_support_amount
    button: |
      **Parents2 share support amount**:
      ${ parents2_share_support_amount }
  - Edit: parents1_other_low_income_adjusted
    button: |
      **Parents2 low income adjustment amount**:
      ${ parents1_other_low_income_adjusted }
  - Edit: parents2_other_low_income_adjusted
    button: |
      **Parents1 low income adjustment amount**:
      ${ parents2_other_low_income_adjusted }
  - Edit: parents2_benchmark_amount
    button: |
      **Parents2 benchmark amount**:
      ${ parents2_benchmark_amount }
  - Edit: parents1_benchmark_amount
    button: |
      **Parents1 benchmark amount**:
      ${ parents1_benchmark_amount }
  - Edit: parents1_other_benchmark_share_amount
    button: |
      **Parents2 benchmark share amount**:
      ${ parents1_other_benchmark_share_amount }
  - Edit: parents2_other_benchmark_share_amount
    button: |
      **Parents1 benchmark share amount**:
      ${ parents2_other_benchmark_share_amount }
  - Edit: parents1_other_adjusted_support_share
    button: |
      **Parents2 adjusted support share amount**:
      ${ parents1_other_adjusted_support_share }
  - Edit: parents2_other_adjusted_support_share
    button: |
      **Parents1 adjusted support share amount**:
      ${ parents2_other_adjusted_support_share }
  - Edit: parents1_income_support_precent
    button: |
      **Parents1 income support precent**:
      ${ parents1_income_support_precent }
  - Edit: parents2_income_support_precent
    button: |
      **Parents2 income support precent**:
      ${ parents2_income_support_precent }
  - Edit: parents2_other_limited_adjusted_amount
    button: |
      **Parents1 adjusted or greater amount**:
      ${ parents2_other_limited_adjusted_amount }
  - Edit: parents1_other_limited_adjusted_amount
    button: |
      **Parents2 adjusted or greater amount**:
      ${ parents1_other_limited_adjusted_amount }
  - Edit: recipient_payor
    button: |
      **Recipient payor**:
      ${ recipient_payor }
  - Edit: payors_adjusted_share_amount
    button: |
      **Payors adjusted share amount**:
      ${ payors_adjusted_share_amount }
  - Edit: mass_gov_yes
    button: |
      **Mass gov**:
      ${ mass_gov_yes }
  - Edit: recipients_support_income_percent
    button: |
      **Recipients support income percent**:
      ${ recipients_support_income_percent }
  - Edit: payors_disparity_adjusted_amount
    button: |
      **Payors disparity adjusted amount**:
      ${ payors_disparity_adjusted_amount }
  - Edit: payors_SS_credit_amount
    button: |
      **Payors ss credit amount**:
      ${ payors_SS_credit_amount }
  - Edit: payors_obligations_amount
    button: |
      **Payors obligations amount**:
      ${ payors_obligations_amount }
  - Edit: obligations_hardship_yes
    button: |
      **Obligations hardship**:
      ${ obligations_hardship_yes }
  - Edit: payors_support_income_percent_amount
    button: |
      **Payors support income percent amount**:
      ${ payors_support_income_percent_amount }
  - Edit: combined_additional_income_amount
    button: |
      **Combined additional income amount**:
      ${ combined_additional_income_amount }
  - Edit: parents1_additional_income_amount
    button: |
      **Parents1 additional income amount**:
      ${ parents1_additional_income_amount }
  - Edit: parents2_additional_income_amount
    button: |
      **Parents2 additional income amount**:
      ${ parents2_additional_income_amount }
  - Edit: docket_number
    button: |
      **docket_number**:
      ${ docket_number }
  - Edit: parents.revisit
    button: |
      **Parents**

      % for item in parents:
        * ${ item }
      % endfor
  - Edit: preparer[0]
    button: |
      **preparer[0]**:
      ${ preparer[0] }
---
continue button field: parents.revisit
question: |
  Edit parents
subquestion: |
  ${ parents.table }

  ${ parents.add_action() }
---
table: parents.table
rows: parents
columns:
  - Name: |
      row_item.name.full() if defined("row_item.name.first") else ""
edit:
  - name.first
confirm: True

---
id: download child_support_guidelines_worksheet
event: child_support_guidelines_worksheet_download
question: |
  All done
subquestion: |
  Thank you ${ preparer_name_full }. Your form is ready to download and deliver.
  
  View, download and send your form below. Click the "Edit answers" button to fix any mistakes.

  ${ action_button_html(url_action('review_child_support_guidelines_worksheet'), label='Edit answers', color='info') }
  
  
  ${ al_user_bundle.download_list_html() }
  

  ${ al_user_bundle.send_button_html(show_editable_checkbox=False) }

progress: 100
---
# calculates combined_available_income_amount
depends on:
  - parents1_available_income_amount
  - parents2_available_income_amount
code : |
  combined_available_income_amount = parents1_available_income_amount + parents2_available_income_amount
  calculate_combined_available_income_amount = True
---
# calculates applicable_income_amount
depends on: 
  - combined_available_income_amount
code: |
 if combined_available_income_amount < 7692: 
   applicable_income_amount = combined_available_income_amount
 else:
   applicable_income_amount = 7692
 calculate_applicable_income_amount = True 
---
# adds up parent 1 available income
depends on:
  - parents1_SS_dependency_amount
  - parents1_gross_amount
  - parents1_other_obligations_amount
  - parents1_health_care_amount
  - parents1_dental_vision_amount
code: |
  if parents1_gross_amount + parents1_SS_dependency_amount - parents1_other_obligations_amount - parents1_health_care_amount - parents1_dental_vision_amount <= 0:
    parents1_available_income_amount = 0
  else:
    parents1_available_income_amount = parents1_gross_amount + parents1_SS_dependency_amount - parents1_other_obligations_amount - parents1_health_care_amount - parents1_dental_vision_amount
  calculate_parents1_available_income_amount = True
---
# gets parent 2 available income
depends on:
  - parents2_SS_dependency_amount
  - parents2_gross_amount
  - parents2_other_obligations_amount
  - parents2_health_care_amount
  - parents2_dental_vision_amount
code: |
  if parents2_gross_amount + parents2_SS_dependency_amount - parents2_other_obligations_amount - parents2_health_care_amount - parents2_dental_vision_amount <= 0:
    parents2_available_income_amount = 0
  else:
    parents2_available_income_amount = parents2_gross_amount + parents2_SS_dependency_amount - parents2_other_obligations_amount - parents2_health_care_amount - parents2_dental_vision_amount
  calculate_parents2_available_income_amount = True
---
# gets parent 1 income share percentage
depends on:
  - parents1_available_income_amount
  - combined_available_income_amount
code: |
  parents1_income_share_percent = round((parents1_available_income_amount / combined_available_income_amount) * 100)
  calculate_parents1_income_share_percent = True
---
# gets parent 2 income share percentage
depends on: 
  - parents2_available_income_amount
  - combined_available_income_amount
code: |
  parents2_income_share_percent = round((parents2_available_income_amount / combined_available_income_amount) * 100)
  calculate_parents2_income_share_percent = True
---
# gets the one child support amount
depends on:
  - applicable_income_amount
code: |
  if round(applicable_income_amount) <= 210:
    one_child_support_amount = 12
  elif round(applicable_income_amount) <= 249:
    one_child_support_amount = 12 + ((applicable_income_amount - 210) * .2)
  elif round(applicable_income_amount) <= 750:
    one_child_support_amount = 12 + (applicable_income_amount * .22)
  elif round(applicable_income_amount) <= 1400:
    one_child_support_amount = 165 + ((applicable_income_amount - 750) * .21)
  elif round(applicable_income_amount) <= 2200:
    one_child_support_amount = 302 + ((applicable_income_amount - 1400) * .19)
  elif round(applicable_income_amount) <= 3500:
    one_child_support_amount = 454 + ((applicable_income_amount - 2200) * .14)
  elif round(applicable_income_amount) <= 5000:
    one_child_support_amount = 636 + ((applicable_income_amount - 3500) * .11)
  # hard coded max applicable_income_amount is 7692. else is that max. 
  else:
    one_child_support_amount = 801 + ((applicable_income_amount - 5000) * .1)    
  calculate_one_child_support_amount = True
---
#finds parents2_child_number_adjustments value
depends on:
  - parents2_total_children_number
code: |
  if parents2_total_children_number < 1:
    parents2_child_number_adjustments = 0
  elif parents2_total_children_number == 1:
    parents2_child_number_adjustments = 1  
  elif parents2_total_children_number == 2:
    parents2_child_number_adjustments = 1.4
  elif parents2_total_children_number == 3:
    parents2_child_number_adjustments = 1.68
  elif parents2_total_children_number == 4:
    parents2_child_number_adjustments = 1.85      
  #The PDF is limited to 5 children. The else here assumes 5 children for the order. 
  else:
    parents2_child_number_adjustments = 1.94
  calculate_parents2_child_number_adjustments = True
---
#finds parents1_child_number_adjustments value
depends on:
  - parents1_total_children_number 
code: | 
  if parents1_total_children_number < 1:
    parents1_child_number_adjustments = 0
  elif parents1_total_children_number == 1:
    parents1_child_number_adjustments = 1
  elif parents1_total_children_number == 2:
    parents1_child_number_adjustments = 1.4
  elif parents1_total_children_number == 3:
    parents1_child_number_adjustments = 1.68
  elif parents1_total_children_number == 4:
    parents1_child_number_adjustments = 1.85
  #The PDF is limited to 5 children. The else here assumes 5 children for the order. 
  else:
    parents1_child_number_adjustments = 1.94    
  calculate_parents1_child_number_adjustments = True
---
# assigns value to parents1_children_adjustments
# based on table c on worksheet (adjustments for children >18 years old)
depends on:
  - parents1_under_18_number
  - parents1_total_children_number
code: |
  if parents1_under_18_number == 0:    
    parents1_children_adjustments = .25
  elif parents1_under_18_number == 1:
    if parents1_total_children_number - parents1_under_18_number == 1: 
      parents1_children_adjustments = .07
    elif parents1_total_children_number - parents1_under_18_number == 2:
      parents1_children_adjustments = .11
    elif parents1_total_children_number - parents1_under_18_number == 3:
      parents1_children_adjustments = .13   
    elif parents1_total_children_number - parents1_under_18_number == 4:
      parents1_children_adjustments = .14  
    else:
      parents1_children_adjustments = 0  
  elif parents1_under_18_number == 2:
    if parents1_total_children_number - parents1_under_18_number == 1:
      parents1_children_adjustments = .04
    elif parents1_total_children_number - parents1_under_18_number == 2:
      parents1_children_adjustments = .06   
    elif parents1_total_children_number - parents1_under_18_number == 3:
      parents1_children_adjustments = .07
    else:
      parents1_children_adjustments = 0
  elif parents1_under_18_number == 3:
    if parents1_total_children_number - parents1_under_18_number == 1:
      parents1_children_adjustments = .02  
    elif parents1_total_children_number - parents1_under_18_number == 2:
      parents1_children_adjustments = .03
    else:
      parents1_children_adjustments = 0
  elif parents1_under_18_number == 4:
    if parents1_total_children_number - parents1_under_18_number == 1:
      parents1_children_adjustments = .01
    else:       
      parents1_children_adjustments = 0 
  else:
    #The PDF is limited to 5 children. The else here assumes 5 children under 18 for the order. 
    parents1_children_adjustments = 0
  calculate_parents1_children_adjustments = True
---
# assigns value to parents2_children_adjustments
# based on table c on worksheet
depends on:
  - parents2_under_18_number
  - parents2_total_children_number
code: |
  if parents2_under_18_number == 0:    
    if parents2_total_children_number - parents2_under_18_number >= 1:
      parents2_children_adjustments = .25
    else:
      parents2_children_adjustments = 0
  elif parents2_under_18_number == 1:
    if parents2_total_children_number - parents2_under_18_number == 1: 
      parents2_children_adjustments = .07
    elif parents2_total_children_number - parents2_under_18_number == 2:
      parents2_children_adjustments = .11
    elif parents2_total_children_number - parents2_under_18_number == 3:
      parents2_children_adjustments = .13   
    elif parents2_total_children_number - parents2_under_18_number == 4:
      parents2_children_adjustments = .14  
    else:
      parents2_children_adjustments = 0  
  elif parents2_under_18_number == 2:
    if parents2_total_children_number - parents2_under_18_number == 1:
      parents2_children_adjustments = .04
    elif parents2_total_children_number - parents2_under_18_number == 2:
      parents2_children_adjustments = .06   
    elif parents2_total_children_number - parents2_under_18_number == 3:
      parents2_children_adjustments = .07
    else:
      parents2_children_adjustments = 0
  elif parents2_under_18_number == 3:
    if parents2_total_children_number - parents2_under_18_number == 1:
      parents2_children_adjustments = .02  
    elif parents2_total_children_number - parents2_under_18_number == 2:
      parents2_children_adjustments = .03
    else:
      parents2_children_adjustments = 0
  elif parents2_under_18_number == 4:
    if parents2_total_children_number - parents2_under_18_number == 1:
      parents2_children_adjustments = .01
    else:       
      parents2_children_adjustments = 0 
  else:
    #The PDF is limited to 5 children. The else here assumes 5 children under 18 for the order. 
    parents2_children_adjustments = 0
  calculate_parents2_children_adjustments = True
---
# setting parents1_share_support_amount - 5a, Parent A
depends on:
  - parents1_income_share_percent
  - parents1_adjusted_support_amount
code: |
  parents1_share_support_amount = round(parents1_adjusted_support_amount * parents1_income_share_percent)
  set_parents1_share_support_percent = True
---
#setting parents2_share_support_amount - 5a, Parent B
#rules from MLRI Guidlines have parents2_share_support_amount blank if two-thirds true. Set to 1 here and will be displayed as DAEmpty() on form. Potential problems in future. 
depends on: 
 - parents2_income_share_percent
 - parents2_adjusted_support_amount
 - parenting_arangment
code: |
 if parenting_arangment == "two-thirds":
   parents2_share_support_amount = 1
 else:
   parents2_share_support_amount = round(parents2_adjusted_support_amount * parents2_income_share_percent)
 set_parents2_share_support_amount = True
---
#setting parents1_other_share_support, 5b, Parent A
depends on:
  - parents1_share_support_amount
  - parents1_adjusted_support_amount
code: |
  parents1_other_share_support = parents1_share_support_amount - parents1_adjusted_support_amount 
  set_parents1_other_share_support = True
---
#setting parents2_other_share_support, 5b, Parent B
#rules from MLRI Guidlines have parents2_share_support_amount blank if two-thirds true. Set to 1 here and will be displayed as DAEmpty() on form. Potential problems in future.
depends on:
 - parents2_share_support_amount
 - parents2_adjusted_support_amount
code: |
  if parenting_arangment == 'two-thirds':
    parents2_other_share_support = 1
  else:
    parents2_other_share_support = parents2_share_support_amount - parents2_adjusted_support_amount
  set_parents2_other_share_support = True
---
#setting parents1_other_low_income_adjusted, 5c, Parent A
#Logic and math are coming from shaded area of table A, not Child Support Guidlines Chart.
depends on:
  - parenting_arangment
  - parents2_available_income_amount
  - parents1_other_share_support
code: |
  if parenting_arangment == "two-thirds":
    if parents2_available_income_amount > 249:
      parents1_other_low_income_adjusted = parents1_other_share_support
    else:
      if parents2_available_income_amount <= 249:
        if parents2_available_income_amount <= 212:
          parents1_other_low_income_adjusted = 12
        elif parents2_available_income_amount == 213:
          parents1_other_low_income_adjusted = 13
        elif parents2_available_income_amount <= 218:
          parents1_other_low_income_adjusted = 14
        elif parents2_available_income_amount <= 223:
          parents1_other_low_income_adjusted = 15
        elif parents2_available_income_amount <= 228:
          parents1_other_low_income_adjusted = 16
        elif parents2_available_income_amount <= 233:
          parents1_other_low_income_adjusted = 17
        elif parents2_available_income_amount <= 238:
          parents1_other_low_income_adjusted = 18
        elif parents2_available_income_amount <= 243:
          parents1_other_low_income_adjusted = 19
        elif parents2_available_income_amount <= 249:
          parents1_other_low_income_adjusted = 20
  else:
    parents1_other_low_income_adjusted = parents1_other_share_support
  calculate_parents1_other_low_income_adjusted = True
---
#sets parents2_other_low_income_adjusted, 5c, Parent B
#Logic and math are coming from shaded area of table A, not Child Support Guidlines Chart.
depends on: 
  - parenting_arangment
  - parents2_other_share_support
  - parents1_available_income_amount
code: |    
  if parenting_arangment == "two-thirds":
    parents2_other_low_income_adjusted = 0     
  else:
    if parents1_available_income_amount > 249:
      parents2_other_low_income_adjusted = parents2_other_share_support
    elif parents1_available_income_amount <= 249:
      if parents1_available_income_amount <= 212:
        parents2_other_low_income_adjusted = 12
      elif parents1_available_income_amount == 213:
        parents2_other_low_income_adjusted = 13
      elif parents1_available_income_amount <= 218:
        parents2_other_low_income_adjusted = 14
      elif parents1_available_income_amount <= 223:
        parents2_other_low_income_adjusted = 15
      elif parents1_available_income_amount <= 228:
        parents2_other_low_income_adjusted = 16
      elif parents1_available_income_amount <= 233:
        parents2_other_low_income_adjusted = 17
      elif parents1_available_income_amount <= 238:
        parents2_other_low_income_adjusted = 18
      elif parents1_available_income_amount <= 243:
        parents2_other_low_income_adjusted = 19
      elif parents1_available_income_amount <= 249:
        parents2_other_low_income_adjusted = 20
  calculate_parents2_other_low_income_adjusted = True
---
#each item in the list is a tupple of (amount for parent 1, total of both parents)
code: |
  parents1_children_amounts = [
    (parents1_child1_amount, child1_total_amount),
    (parents1_child2_amount, child2_total_amount),
    (parents1_child3_amount, child3_total_amount),
    (parents1_child4_amount, child4_total_amount),
    (parents1_child5_amount, child5_total_amount)
  ]
  get_parents1_children_amounts = True
---
#each item in the list is a tupple of (amount for parent 2, total of both parents)
depends on:
  - parents2_total_children_number
code: |
  parents2_children_amounts = [
    (parents2_child1_amount, child1_total_amount),
    (parents2_child2_amount, child2_total_amount),
    (parents2_child3_amount, child3_total_amount),
    (parents2_child4_amount, child4_total_amount),
    (parents2_child5_amount, child5_total_amount)
  ]
  get_parents2_children_amounts = True
---
# sets parents1_benchmark_amount, 6a, Parent A
# all the depends on values are definitley defined elsewhere 
depends on:
  - parents1_total_children_number
  - parents1_children_amounts
  - child1_total_amount
  - child2_total_amount
  - child3_total_amount
  - child4_total_amount
  - child5_total_amount
  - parents1_child1_amount
  - parents1_child2_amount
  - parents1_child3_amount
  - parents1_child4_amount
  - parents1_child5_amount 
code: |  
  children_amounts = []
  for child_index in range(len(parents1_children_amounts)):
    #get the tupple of the two values for this child.
    child_amounts = parents1_children_amounts[child_index]
    both_parents_child_total = child_amounts[1]
    if both_parents_child_total <= 355:
      child_benchmark_amount = child_amounts[0]
    else:
      child_benchmark_amount = child_amounts[0] * (355 / both_parents_child_total)
    children_amounts.append(child_benchmark_amount)
  
  parents1_benchmark_amount = sum(children_amounts)
---
# sets parents2_benchmark_amount, 6a, Parent B
# all the depends on values are definitley defined elsewhere 
depends on:
  - parents2_total_children_number
  - parents2_children_amounts
  - child1_total_amount
  - child2_total_amount
  - child3_total_amount
  - child4_total_amount
  - child5_total_amount
  - parents2_child1_amount
  - parents2_child2_amount
  - parents2_child3_amount
  - parents2_child4_amount
  - parents2_child5_amount 
code: |  
  children_amounts = []
  for child_index in range(len(parents2_children_amounts)):
    #get the tupple of the two values for this child.
    child_amounts = parents2_children_amounts[child_index]
    both_parents_child_total = child_amounts[1]
    if both_parents_child_total <= 355:
      child_benchmark_amount = child_amounts[0]
    else:
      child_benchmark_amount = child_amounts[0] * (355 / both_parents_child_total)
    children_amounts.append(child_benchmark_amount)
  
  parents2_benchmark_amount = sum(children_amounts)
---
#For Parent A: Parent B 3c x Parent A 6a
#For Parent B: Parent A 3c x Parent B 6a
#setting parents1_other_benchmark_share_amount, 6b Parent A
#potentially intervening variable, could just use the (parents2_income_share_percent * parents1_benchmark_amount) in place of any use. 
#depends on:
#  - parents1_benchmark_amount
#  - parents2_income_share_percent
#code:
#  parents1_other_benchmark_share_amount = parents2_income_share_percent * parents1_benchmark_amount
---
#setting parents2_other_benchmark_share_amount, 6b Parent B
#trigger problems?
#potentially intervening variable, coudl just use the (parents1_income_share_percent * parents2_benchmark_amount) in place of any use. 
#depends on:
#  - parents2_benchmark_amount
#  - parents1_income_share_percent
#code: |
#  parents2_other_benchmark_share_amount = parents1_income_share_percent * parents2_benchmark_amount
---
#sets combined_additional_income_amount, 8a
depends on:
  - combined_available_income_amount
code: |
  if combined_available_income_amount - 7692 > 0:
    combined_additional_income_amount = combined_available_income_amount - 7692
  else:
    0
  set_combined_additional_income_amount = True
---
#sets parents1_income_support_precent, 6d, Parent A
depends on:
  - two_thirds_yes
  - parents1_available_income_amount
code: |
  if two_thirds_yes == True:
    parents1_income_support_precent = DAEmpty()
  else:
     if parents1_available_income_amount <= 0:
       parents1_income_support_precent = 100
     else:
       parents1_income_support_precent = parents2_other_adjusted_support_share / parents1_available_income_amount          
  set_parents1_income_support_precent = True
---
#sets parents1_other_limited_adjusted_amount, 6e, Parent A
depends on:
  - parents1_income_support_precent
  - parents2_income_share_percent
  - parents1_other_adjusted_support_share
code: |
  if parents1_income_support_precent == DAEmpty():
    parents1_other_limited_adjusted_amount = parents1_other_adjusted_support_share
  elif parents1_income_support_precent >= 10:
    parents1_other_limited_adjusted_amount = parents1_other_adjusted_support_share
  else:
    if parents1_other_adjusted_support_share <= ((parents1_income_support_precent + (parents1_income_support_precent * .1)) * parents2_income_share_percent):
      parents1_other_limited_adjusted_amount = parents1_other_adjusted_support_share
    else:
      parents1_other_limited_adjusted_amount = ((parents1_income_support_precent + (parents1_income_support_precent * .1)) * parents2_income_share_percent)
  calculate_parents1_other_limited_adjusted_amount = True  
---
code: |
  signature_fields = []
  parents1_total_children_number = parents1_over_18_number + parents1_under_18_number
  parents2_total_children_number = parents2_over_18_number + parents2_under_18_number
  parents1_all_children_amount = parents1_child1_amount + parents1_child2_amount + parents1_child3_amount + parents1_child4_amount + parents1_child5_amount
  parents2_all_children_amount = parents2_child1_amount + parents2_child2_amount + parents2_child3_amount + parents2_child4_amount + parents2_child5_amount
  child2_total_amount = parents1_child1_amount + parents2_child2_amount
  child3_total_amount = parents1_child3_amount + parents2_child3_amount
  child4_total_amount = parents1_child4_amount + parents2_child4_amount
  child5_total_amount = parents1_child5_amount + parents2_child5_amount
  child1_total_amount = parents1_child1_amount + parents2_child1_amount
  parents2_support_amount = one_child_support_amount * parents2_child_number_adjustments
  parents1_support_amount = one_child_support_amount * parents1_child_number_adjustments
  parents1_over_18_adjustments_amount = parents1_support_amount * parents1_children_adjustments
  parents2_over_18_adjustments_amount = parents2_support_amount * parents2_children_adjustments
  parents1_adjusted_support_amount = DAEmpty()
  parents2_adjusted_support_amount = DAEmpty()
  parents1_other_low_income_adjusted = DAEmpty()
  parents2_other_low_income_adjusted = DAEmpty()
  parents1_other_adjusted_support_share = DAEmpty()
  parents2_other_adjusted_support_share = DAEmpty()
  parents2_income_support_precent = DAEmpty()
  parents2_other_limited_adjusted_amount = DAEmpty()
  recipient_payor = DAEmpty()
  payors_adjusted_share_amount = DAEmpty()
  recipients_support_income_percent = DAEmpty()
  payors_disparity_adjusted_amount = DAEmpty()
  payors_SS_credit_amount = DAEmpty()
  payors_obligations_amount = DAEmpty()
  obligations_hardship_yes = DAEmpty()
  payors_support_income_percent_amount = DAEmpty()
  parents1_additional_income_amount = DAEmpty()
  parents2_additional_income_amount = DAEmpty()
  parents1_other_benchmark_share_amount = DAEmpty()
  parents2_other_benchmark_share_amount = DAEmpty()
---
objects:
  - child_support_guidelines_worksheet_post_interview_instructions: ALDocument.using(title="Instructions", filename="child_support_guidelines_worksheet_next_steps.docx", enabled=True, has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
  - child_support_guidelines_worksheet_attachment: ALDocument.using(title="Child Support Guidelines Worksheet", filename="child_support_guidelines_worksheet.pdf", enabled=True, has_addendum=False, default_overflow_message=AL_DEFAULT_OVERFLOW_MESSAGE)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(elements=[child_support_guidelines_worksheet_post_interview_instructions,child_support_guidelines_worksheet_attachment], filename="child_support_guidelines_worksheet.pdf_package.pdf", title="All forms to download for your records", enabled=True)
  - al_recipient_bundle: ALDocumentBundle.using(elements=[child_support_guidelines_worksheet_attachment], filename="child_support_guidelines_worksheet.pdf_package.pdf", title="All forms to download for your records", enabled=True)
--- 
attachments:
  - name: child support guidelines worksheet post interview instructions
    filename: Post-interview-instructions     
    variable name: child_support_guidelines_worksheet_post_interview_instructions[i]        
    skip undefined: True
    docx template file: child_support_guidelines_worksheet_next_steps.docx
  - name: child support guidelines worksheet attachment
    filename: child_support_guidelines_worksheet.pdf     
    variable name: child_support_guidelines_worksheet_attachment[i]        
    skip undefined: True
    pdf template file: child_support_guidelines_worksheet.pdf
    fields:
      - "docket_number": ${ docket_number }
      - "docket_number__1": ${ docket_number }
      - "docket_number__2": ${ docket_number }
      - "docket_number__3": ${ docket_number }
      - "parents1_name_full": ${ parents1_name_full }
      - "parents1_name__1": ${ parents1_name_full }
      - "parents1_name__2": ${ parents1_name_full }
      - "parents1_name__3": ${ parents1_name_full }
      - "parents2_name_full": ${ parents2_name_full }
      - "parents2_name__1": ${ parents2_name_full }
      - "parents2_name__2": ${ parents2_name_full }
      - "parents2_name__3": ${ parents2_name_full }
      - "preparer_name_full": ${ preparer_name_full }
      - "case_name": ${ case_name }
      - "case_name__1": ${ case_name }
      - "case_name__2": ${ case_name }
      - "case_name__3": ${ case_name }
      - "prepared_date": ${ prepared_date }
      - "children_number": ${ "{:,.2f}".format(children_number) }
      - "shared_equal_yes": ${ shared_equal_yes }
      - "two_thirds_yes": ${ two_thirds_yes }
      - "split_children_yes": ${ split_children_yes }
      - "parents1_under_18_number": ${ "{:,.2f}".format(parents1_under_18_number) }
      - "parents2_under_18_number": ${ "{:,.2f}".format(parents2_under_18_number) }
      - "parents1_over_18_number": ${ "{:,.2f}".format(parents1_over_18_number) }
      - "parents2_over_18_number": ${ "{:,.2f}".format(parents2_over_18_number) }
      - "parents1_total_children_number": ${ parents1_over_18_number + parents1_under_18_number }
      - "parents2_total_children_number": ${ parents2_over_18_number + parents2_under_18_number }
      - "parents1_gross_amount": ${ currency(parents1_gross_amount) }
      - "parents2_gross_amount": ${ currency(parents2_gross_amount) }
      - "parents1_SS_dependency_amount": ${ currency(parents1_SS_dependency_amount) }
      - "parents2_SS_dependency_amount": ${ currency(parents2_SS_dependency_amount) }
      - "parents2_SS_dependency_recievied_amount": ${ currency(parents2_SS_dependency_recievied_amount) }
      - "parents1_SS_dependency_recievied_amount": ${ currency(parents1_SS_dependency_recievied_amount) }
      - "parents1_other_obligations_amount": ${ currency(parents1_other_obligations_amount) }
      - "parents2_other_obligations_amount": ${ currency(parents2_other_obligations_amount) }
      - "parents1_health_care_amount": ${ currency(parents1_health_care_amount) }
      - "parents2_health_care_amount": ${ currency(parents2_health_care_amount) }
      - "parents1_dental_vision_amount": ${ currency(parents1_dental_vision_amount) }
      - "parents2_dental_vision_amount": ${ currency(parents2_dental_vision_amount) }
      - "parents1_child2_amount": ${ currency(parents1_child2_amount) }
      - "parents1_child5_amount": ${ currency(parents1_child5_amount) }
      - "parents1_child1_amount": ${ currency(parents1_child1_amount) }
      - "parents1_child3_amount": ${ currency(parents1_child3_amount) }
      - "parents1_child4_amount": ${ currency(parents1_child4_amount) }
      - "parents1_all_children_amount": ${ currency(parents1_child1_amount + parents1_child2_amount + parents1_child3_amount + parents1_child4_amount + parents1_child5_amount) }
      - "parents2_all_children_amount": ${ currency(parents2_child1_amount + parents2_child2_amount + parents2_child3_amount + parents2_child4_amount + parents2_child5_amount) }
      - "parents2_child1_amount": ${ currency(parents2_child1_amount) }
      - "parents2_child2_amount": ${ currency(parents2_child2_amount) }
      - "parents2_child3_amount": ${ currency(parents2_child3_amount) }
      - "parents2_child4_amount": ${ currency(parents2_child4_amount) }
      - "parents2_child5_amount": ${ currency(parents2_child5_amount) }
      - "child2_total_amount": ${ currency(parents1_child2_amount + parents2_child2_amount) }
      - "child3_total_amount": ${ currency(parents1_child3_amount + parents2_child3_amount) }
      - "child4_total_amount": ${ currency(parents1_child4_amount + parents2_child4_amount) }
      - "child5_total_amount": ${ currency(parents1_child5_amount + parents2_child5_amount) }
      - "child1_total_amount": ${ currency(parents1_child1_amount + parents2_child1_amount) }
      - "parents2_available_income_amount": ${ currency(parents2_available_income_amount) }
      - "parents1_available_income_amount": ${ currency(parents1_available_income_amount) }     
      - "combined_available_income_amount": ${ currency(combined_available_income_amount) }
      - "parents2_income_share_percent": ${ parents2_income_share_percent } %
      - "parents1_income_share_percent": ${ parents1_income_share_percent } %
      - "applicable_income_amount": |
           % if combined_available_income_amount < 7692: 
           ${ currency(combined_available_income_amount) }
           % else:
           ${ currency(7692) }
           % endif
      - "one_child_support_amount": ${ currency(one_child_support_amount) }           
      - "parents2_child_number_adjustments": ${ parents2_child_number_adjustments }        
      - "parents1_child_number_adjustments": ${ parents1_child_number_adjustments }
      - "parents2_support_amount": ${ currency(one_child_support_amount * parents2_child_number_adjustments) }
      - "parents1_support_amount": ${ currency(one_child_support_amount * parents1_child_number_adjustments) }
      - "parents1_children_adjustments": ${ parents1_children_adjustments }
      - "parents2_children_adjustments": ${ parents2_children_adjustments }
      - "parents1_over_18_adjustments_amount": ${ parents1_support_amount * parents1_children_adjustments }
      - "parents2_over_18_adjustments_amount": ${ parents2_support_amount * parents2_children_adjustments }
      - "parents1_adjusted_support_amount": ${ currency(parents1_support_amount - parents1_over_18_adjustments_amount) }
      - "parents2_adjusted_support_amount": ${ currency(parents2_support_amount - parents2_over_18_adjustments_amount) }
      - "parents1_share_support_amount":  ${ parents1_share_support_amount } %
      - "parents1_other_share_support": ${ parents1_other_share_support } %
      - "parents2_other_share_support": |
           % if parents2_other_share_support == 1:
           N/A
           % else:
           ${ parents2_other_share_support = parents2_other_share_support } % 
           % endif
      - "parents2_share_support_amount": |
           % if parents2_share_support_amount == 1:
           N/A
           % else:
           ${ parents2_share_support_amount = parents2_share_support_amount } %
           % endif      
      - "parents1_other_low_income_adjusted": ${ parents1_other_low_income_adjusted } %
      - "parents2_other_low_income_adjusted": ${ parents2_other_low_income_adjusted } %
      - "parents2_benchmark_amount": ${ parents2_benchmark_amount }
      - "parents1_benchmark_amount": ${ parents1_benchmark_amount }
      - "parents1_other_benchmark_share_amount": ${ parents2_income_share_percent * parents1_benchmark_amount } %
      - "parents2_other_benchmark_share_amount": ${ parents1_income_share_percent * parents2_benchmark_amount } %
      - "parents1_other_adjusted_support_share": ${ (parents2_income_share_percent * parents1_benchmark_amount) + parents1_other_low_income_adjusted } %
      - "parents2_other_adjusted_support_share": ${ (parents1_income_share_percent * parents2_benchmark_amount) + parents2_other_low_income_adjusted } %
      - "parents1_income_support_precent": |
          % if parents1_income_support_precent == DAEmpty():
          N/A
          % else:
          ${ parents1_income_support_precent } %
          %endif
      - "parents2_income_support_precent": |
          % if two_thirds_yes == True:
          N/A
          % elif two_thirds_yes == False:
            % if parents2_available_income_amount == 0:
            100%
            % elif parents2_available_income_amount >= .1:
            ${ parents1_other_adjusted_support_share / parents1_available_income_amount } %
            % endif
          % endif
      - "parents2_other_limited_adjusted_amount": ${ parents2_other_limited_adjusted_amount }          
         # % if parents1_available_income_amount >= parents2_available_income_amount * .1:
         # ${ parents2_other_limited_adjusted_amount } = ${ parents2_other_adjusted_support_share }
         # % elif parents1_available_income_amount == N/A:
         # ${ parents2_other_limited_adjusted_amount } = ${ parents2_other_adjusted_support_share }
         # % elif parents1_available_income_amount <= parents2_available_income_amount * .1:
         #   % if 6D < (parents1 _support_percent + (parents1_income_support_percent * .1)):
         #   & { parents2_other_limited_adjusted_amount } = 6C
         #   % elif 6D > (parents1 _support_percent + (parents1_income_support_percent * .1)) * 3A:
         #     % if parents2_available_income_amount < 12:
         #     ${ parents2_other_limited_adjusted_amount } = 12           
         #     % elif parents2_available_income_amount > 12:
         #     % if parents_1_adjusted_income_amount < (parents1_available_income_amount * .1):
         #     ${ parents2_other_limited_adjusted_amount } = { parents2_other_adjusted_support_share }
         #     % elif 
         #     ${ 
         #     % endif
         #   % endif
         # % endif
      #	If 6d { parents1_available_income_amount } is less {<=} than 10% of the other parent's available income { parents2_available_income_amount * .1 } put whichever is less-	
      # 6c { parents2_other_adjusted_support_share }, or 
      #	add 6d plus 10% { (parents1_income_support_percent + (parents1_income_support_percent * .1)) *}. Multiply the answer times the other parent’s income 3a, but not less than an amount from the shaded area of Table A in the Guidelines Chart (12)     
      - "parents1_other_limited_adjusted_amount": ${ parents1_other_limited_adjusted_amount }
      - "recipient_payor": |
          % if parenting_arangment == "two-thirds":
          Recipient         
          % else:
            % if parents2_other_limited_adjusted_amount < parents1_other_limited_adjusted_amount:
            Recipient
            % endif
          % endif
      - "payor_recipient": |       
          % if two_thirds_yes == True:
          Payor
          % elif two_thirds_yes == False:
            % if parents1_other_limited_adjusted_amount < parents2_other_limited_adjusted_amount:
           Recipient
            % elif parents1_other_limited_adjusted_amount > parents2_other_limited_adjusted_amount:
            Payor
            % endif
          % endif
      - "payors_adjusted_share_amount": ${ payors_adjusted_share_amount } 
      - "mass_gov_yes": ${ mass_gov_yes }
      - "recipients_support_income_percent": ${ recipients_support_income_percent }
      - "payors_disparity_adjusted_amount": ${ payors_disparity_adjusted_amount }
      - "payors_SS_credit_amount": ${ payors_SS_credit_amount }
      - "payors_obligations_amount": |
          % if payors_disparity_adjusted_amount > payors_SS_credit_amount:
          ${ payors_obligations_amount } = ${ payors_disparity_adjusted_amount - payors_SS_credit_amount }
          % elif payors_disparity_adjusted_amount <= payors_SS_credit_amount:
          ${ payors_obligations_amount } = $0
          % endif
      - "obligations_hardship_yes": ${ obligations_hardship_yes }
      - "payors_support_income_percent_amount": ${ payors_support_income_percent_amount }
      - "combined_additional_income_amount": ${ currency(combined_additional_income_amount) }
      - "parents1_additional_income_amount": ${ combined_additional_income_amount * round(parents1_available_income_amount / combined_available_income_amount) } %
      - "parents2_additional_income_amount": ${ combined_additional_income_amount * round(parents2_available_income_amount / combined_available_income_amount) } %